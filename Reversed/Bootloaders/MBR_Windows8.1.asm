xor ax,ax
mov ss,ax
mov sp,0x7c00
mov es,ax
mov ds,ax
mov si,0x7c00
mov di,0x600
mov cx,0x200
cld
rep movsb
push ax
push word 0x61c
retf
sti
mov cx,0x4
mov bp,0x7be
cmp byte [bp+0x0],0x0
jl 0x34
jnz near 0x13b
add bp,byte +0x10
loop 0x23
int 0x18
mov [bp+0x0],dl
push bp
mov byte [bp+0x11],0x5
mov byte [bp+0x10],0x0
mov ah,0x41
mov bx,0x55aa
int 0x13
pop bp
jc 0x59
cmp bx,0xaa55
jnz 0x59
test cx,0x1
jz 0x59
inc byte [bp+0x10]
pushad
cmp byte [bp+0x10],0x0
jz 0x87
push dword 0x0
push dword [bp+0x8]
push word 0x0
push word 0x7c00
push word 0x1
push word 0x10
mov ah,0x42
mov dl,[bp+0x0]
mov si,sp
int 0x13
lahf
add sp,byte +0x10
sahf
jmp short 0x9b
mov ax,0x201
mov bx,0x7c00
mov dl,[bp+0x0]
mov dh,[bp+0x1]
mov cl,[bp+0x2]
mov ch,[bp+0x3]
int 0x13
popad
jnc 0xbb
dec byte [bp+0x11]
jnz 0xb0
cmp byte [bp+0x0],0x80
jz near 0x136
mov dl,0x80
jmp short 0x34
push bp
xor ah,ah
mov dl,[bp+0x0]
int 0x13
pop bp
jmp short 0x59
cmp word [0x7dfe],0xaa55
jnz 0x131
push word [bp+0x0]
call 0x156
jnz 0xe2
cli
mov al,0xd1
out 0x64,al
call 0x156
mov al,0xdf
out 0x60,al
call 0x156
mov al,0xff
out 0x64,al
call 0x156
sti
mov ax,0xbb00
int 0x1a
and eax,eax
jnz 0x127
cmp ebx,0x41504354
jnz 0x127
cmp cx,0x102
jc 0x127
push dword 0xbb07
push dword 0x200
push dword 0x8
push ebx
push ebx
push ebp
push dword 0x0
push dword 0x7c00
popad
push word 0x0
pop es
int 0x1a
pop dx
xor dh,dh
jmp 0x0:0x7c00
int 0x18
mov al,[0x7b7]
jmp short 0x13e
mov al,[0x7b6]
jmp short 0x13e
mov al,[0x7b5]
xor ah,ah
add ax,0x700
mov si,ax
lodsb
cmp al,0x0
jz 0x153
mov bx,0x7
mov ah,0xe
int 0x10
jmp short 0x145
hlt
jmp short 0x153
sub cx,cx
in al,0x64
jmp short 0x15c
and al,0x2
loopne 0x158
and al,0x2
ret
dec cx
outsb
jna 0x1c8
insb
imul sp,[si+0x20],word 0x6170
jc 0x1e3
imul si,[si+0x69],word 0x6e6f
and [si+0x61],dh
bound bp,[si+0x65]
add [di+0x72],al
jc 0x1ee
jc 0x1a1
insb
outsw
popa
imul bp,[fs:bp+0x67],word 0x6f20
jo 0x1f1
jc 0x1ef
jz 0x1f9
outsb
and [ebx+0x79],dh
jnc 0x20b
gs insw
add [di+0x69],cl
jnc 0x211
imul bp,[bp+0x67],word 0x6f20
jo 0x20a
jc 0x208
jz 0x212
outsb
and [ebx+0x79],dh
jnc 0x224
gs insw
add [bx+si],al
add [bp+di+0x7b],ah
call 0x5404:0x8bc0
mov dl,0x95
and byte [bx+si],0x21
add [bx],al
mov si,0x2c12
add [bx+si],cl
add [bx+si],al
add al,dh
or al,[bx+si]
add [bp+0x2c13],bh
pop es
db 0xfe
db 0xff
inc word [bx+si]
clc
or al,[bx+si]
add [bx+si],dl
xor ax,0x1f
db 0xfe
db 0xff
inc word [bx]
db 0xfe
db 0xff
inc word [bx+si]
or [bx+si+0x1f],al
add [bx+si],ah
movsb
sbb [bx+si],al
add [bx+si],al
add [bx+si],al
add [bx+si],al
add [bx+si],al
add [bx+si],al
add [bx+si],al
add [bx+si],al
add [di-0x56],dl
